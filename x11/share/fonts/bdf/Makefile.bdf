#	$NetBSD: Makefile.bdf,v 1.4 2004/02/09 04:30:05 lukem Exp $

FILESDIR=	${X11FONTDIR}/${FONTSUBDIR}
.PATH:  	${X11SRCDIR.xc}/fonts/bdf/${FONTSUBDIR}

FONTSUFFIX=	.gz
FONTGZIP=	| gzip ${GZIPLEVEL:U-9} -cf

.include "${NETBSDSRCDIR}/x11/tools/bdftopcf/Makefile.bdftopcf"
.include "${NETBSDSRCDIR}/x11/tools/ucs2any/Makefile.ucs2any"

.for _F _M in ${UCSFILES}						# {
${_F}-${_M}.bdf: ${_F}.bdf
	${_MKTARGET_CREATE}
	${UCS2ANY} ${.ALLSRC} ${DESTDIR}${X11FONTDIR}/util/map-${_M} ${_M}

CLEANFILES+=	${_F}-${_M}.bdf
BDFFILES+=	${_F}-${_M}.bdf
.endfor									# }

.SUFFIXES: .bdf .pcf${FONTSUFFIX}

.bdf.pcf${FONTSUFFIX}:
	${_MKTARGET_CREATE}
	rm -f ${.TARGET}
	${BDFTOPCF} -t ${.IMPSRC} ${FONTGZIP} > ${.TARGET}.tmp \
	&& mv ${.TARGET}.tmp ${.TARGET}

PCFFILES+=	${BDFFILES:S/.bdf$/.pcf${FONTSUFFIX}/}
CLEANFILES+=	${PCFFILES}
CLEANFILES+=	${BDFFILES:S/.bdf$/.pcf${FONTSUFFIX}.tmp/}

FILES+=		${PCFFILES}
.if exists(fonts.alias)
FILES+=		fonts.alias
.endif

realall:	${PCFFILES}


.include "../Makefile.mkfontdir"
