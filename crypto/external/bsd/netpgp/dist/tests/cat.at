# $NetBSD: cat.at,v 1.1 2009/05/27 22:13:06 agc Exp $

AT_SETUP([attached signature and verification])

cp ${TOPSRCDIR}/libtool file3

# Make signature
AT_CHECK([$NETPGP --homedir $testhomedir --sign file3],
    [0], [ignore], [ignore])

# Verify sig file
AT_CHECK([$NETPGP --homedir $testhomedir --cat --output=file3.copy file3.gpg],
    [0], [ignore], [ignore], [ignore], [diff file3.copy file3])

# Verify sig to stdout
AT_CHECK([$NETPGP --homedir $testhomedir --cat file3.gpg],
    [0], [ignore], [ignore], [ignore], [diff stdout file3])

# XXXTODO: deliberately corrupt file3.gpg and attempt to verify

AT_CLEANUP
